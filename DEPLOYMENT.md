# Deployment Guide for Cattle Health Management System with Roboflow AI

This guide will help you deploy the complete Cattle Health Management System with Roboflow AI integration to Render.

## Prerequisites

1. A Render account (sign up at https://render.com)
2. Your code pushed to a GitHub repository
3. Roboflow account and API key (for AI disease detection)
4. Environment variables configured

## System Architecture

The system consists of four main components:
- **Backend**: Django REST API with PostgreSQL database
- **Frontend**: React application with Material-UI
- **AI Service**: Flask service with Roboflow integration for disease detection
- **Database**: PostgreSQL database for data storage

## Deployment Steps

### Option 1: Deploy All Services Together (Recommended)

1. **Connect your GitHub repository to Render:**
   - Go to your Render dashboard
   - Click "New" ‚Üí "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect the `render.yaml` file and deploy all services

2. **The deployment will automatically create:**
   - Backend API service at `https://cattle-health-backend.onrender.com`
   - Frontend web app at `https://cattle-health-frontend.onrender.com`
   - AI service with Roboflow at `https://cattle-health-ai.onrender.com`
   - PostgreSQL database

### Option 2: Deploy Services Individually

#### Backend Deployment

1. **Create a new Web Service:**
   - Go to Render dashboard
   - Click "New" ‚Üí "Web Service"
   - Connect your GitHub repository
   - Set the following:
     - **Name:** `cattle-health-backend`
     - **Environment:** `Python`
     - **Build Command:** `cd backend && chmod +x build.sh && ./build.sh`
     - **Start Command:** `cd backend && gunicorn cattle_health.wsgi:application`
     - **Python Version:** `3.11.0`

2. **Create PostgreSQL Database:**
   - Click "New" ‚Üí "PostgreSQL"
   - Name: `cattle-health-db`
   - Plan: Free

3. **Configure Environment Variables:**
   ```
   DATABASE_URL=<auto-generated from database>
   DJANGO_SETTINGS_MODULE=cattle_health.settings
   DEBUG=False
   ALLOWED_HOSTS=cattle-health-backend.onrender.com,localhost,127.0.0.1
   SECRET_KEY=<generate a secure key>
   CORS_ALLOWED_ORIGINS=https://cattle-health-frontend.onrender.com,http://localhost:3000
   ```

#### AI Service with Roboflow Deployment

1. **Create a new Web Service:**
   - Click "New" ‚Üí "Web Service"
   - Connect your GitHub repository
   - Set the following:
     - **Name:** `cattle-health-ai`
     - **Environment:** `Python`
     - **Build Command:** `cd ai_service && pip install -r requirements.txt`
     - **Start Command:** `cd ai_service && gunicorn app_roboflow:app`
     - **Python Version:** `3.11.0`

2. **Configure Roboflow Environment Variables:**
   ```
   FLASK_ENV=production
   PORT=10000
   ROBOFLOW_API_KEY=8jChB8UhLyeJtPEO8Kqs
   ROBOFLOW_WORKSPACE=cattledisease-tmqqu
   ROBOFLOW_PROJECT=my-first-project-kills
   ROBOFLOW_VERSION=2
   ```

#### Frontend Deployment

1. **Create a new Static Site:**
   - Click "New" ‚Üí "Static Site"
   - Connect your GitHub repository
   - Set the following:
     - **Name:** `cattle-health-frontend`
     - **Build Command:** `cd frontend && npm ci && npm run build`
     - **Publish Directory:** `frontend/build`

2. **Configure Environment Variables:**
   ```
   REACT_APP_API_URL=https://cattle-health-backend.onrender.com/api
   REACT_APP_AI_SERVICE_URL=https://cattle-health-ai.onrender.com
   ```

## Roboflow AI Integration

The system includes advanced AI-powered disease detection using Roboflow:

### Features:
- **Lumpy Skin Disease Detection**: Trained model for detecting cattle diseases from images
- **Real-time Analysis**: Instant disease prediction from uploaded images
- **Confidence Scoring**: Provides confidence levels for predictions
- **Symptom Correlation**: Combines image analysis with symptom data

### Roboflow Configuration:
- **Workspace**: `cattledisease-tmqqu`
- **Project**: `my-first-project-kills`
- **Model Version**: `2`
- **API Key**: Pre-configured for deployment

### AI Service Endpoints:
- `GET /health` - Health check
- `POST /api/ai/predict` - Disease prediction from images and symptoms
- `POST /comprehensive-analysis` - Advanced analysis combining multiple data sources
- `GET /model-info` - Model information and capabilities

## Post-Deployment Steps

1. **Verify Services:**
   - ‚úÖ Backend API: `https://cattle-health-backend.onrender.com/api/health/`
   - ‚úÖ Frontend: `https://cattle-health-frontend.onrender.com`
   - ‚úÖ AI Service: `https://cattle-health-ai.onrender.com/health`
   - ‚úÖ Database: Connected and migrated

2. **Test AI Integration:**
   - Upload cattle images for disease detection
   - Verify Roboflow model responses
   - Test symptom reporting with AI predictions

3. **Create Admin User:**
   - The build script automatically creates an admin user
   - Email: `admin@cattlehealth.com`
   - Password: `admin123`
   - **Important:** Change this password immediately after deployment

4. **Test Complete Workflow:**
   - Register as cattle owner and veterinarian
   - Add cattle records with images
   - Submit symptom reports
   - Verify AI disease predictions
   - Test veterinarian notification system
   - Verify consultation request workflow

## Environment Variables Reference

### Backend Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `DATABASE_URL` | PostgreSQL connection string | Yes |
| `SECRET_KEY` | Django secret key | Yes |
| `DEBUG` | Debug mode (False for production) | Yes |
| `ALLOWED_HOSTS` | Comma-separated list of allowed hosts | Yes |
| `CORS_ALLOWED_ORIGINS` | Comma-separated list of allowed CORS origins | Yes |

### AI Service Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `FLASK_ENV` | Flask environment | Yes |
| `PORT` | Service port (10000 for Render) | Yes |
| `ROBOFLOW_API_KEY` | Roboflow API key for AI models | Yes |
| `ROBOFLOW_WORKSPACE` | Roboflow workspace name | Yes |
| `ROBOFLOW_PROJECT` | Roboflow project name | Yes |
| `ROBOFLOW_VERSION` | Model version number | Yes |

### Frontend Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `REACT_APP_API_URL` | Backend API URL | Yes |
| `REACT_APP_AI_SERVICE_URL` | AI service URL | Yes |

## System Features

### For Cattle Owners:
- üêÑ **Cattle Management**: Register and manage cattle with photos
- üì± **Symptom Reporting**: Report symptoms with AI-powered disease detection
- üîî **Automatic Notifications**: Get notified when veterinarians respond
- üìä **Health Analytics**: Track cattle health trends and history
- üí¨ **Consultation System**: Connect with veterinarians for consultations

### For Veterinarians:
- üìã **Request Management**: Receive and manage consultation requests
- üè• **Patient Dashboard**: Track accepted patients and cases
- üìà **Dashboard Statistics**: Monitor workload and performance metrics
- üö® **Emergency Handling**: Priority notifications for emergency cases
- ü§ñ **AI Assistance**: Access AI predictions to support diagnoses

### AI-Powered Features:
- üî¨ **Disease Detection**: Roboflow-trained model for Lumpy Skin Disease
- üì∏ **Image Analysis**: Analyze cattle images for disease symptoms
- üß† **Smart Predictions**: Combine symptoms and images for accurate diagnosis
- ‚ö° **Real-time Processing**: Instant AI analysis and recommendations

## Troubleshooting

### Common Issues

1. **AI Service Not Responding:**
   - Check Roboflow API key is valid
   - Verify internet connectivity for Roboflow API calls
   - Check service logs for authentication errors

2. **Image Upload Failures:**
   - Ensure images are under 10MB
   - Check supported formats (JPEG, PNG)
   - Verify AI service is running

3. **Database Connection Issues:**
   - Ensure DATABASE_URL is correctly set
   - Check that the PostgreSQL service is running
   - Verify database migrations ran successfully

4. **CORS Issues:**
   - Ensure CORS_ALLOWED_ORIGINS includes your frontend URL
   - Check that the frontend is making requests to the correct backend URL

### Monitoring and Logs

- **Backend Logs**: Check Django application logs in Render dashboard
- **AI Service Logs**: Monitor Flask service logs for Roboflow API calls
- **Frontend Logs**: Check browser console for client-side errors
- **Database Logs**: Monitor PostgreSQL connection and query logs

## Performance Optimization

1. **AI Service Optimization:**
   - Image compression before sending to Roboflow
   - Caching of frequent predictions
   - Batch processing for multiple images

2. **Database Optimization:**
   - Indexed queries for fast lookups
   - Optimized cattle and consultation queries
   - Efficient notification system

3. **Frontend Optimization:**
   - Lazy loading of components
   - Image optimization and compression
   - Efficient state management

## Security Considerations

1. **API Security:**
   - HTTPS enforced for all communications
   - JWT authentication for API access
   - Rate limiting on AI service endpoints

2. **Data Protection:**
   - Secure image upload and storage
   - Encrypted database connections
   - Protected Roboflow API keys

3. **User Security:**
   - Strong password requirements
   - Secure session management
   - Role-based access control

## Scaling and Production

1. **Free Tier Limitations:**
   - Services may sleep after 15 minutes of inactivity
   - Limited CPU and memory resources
   - Consider upgrading to paid plans for production use

2. **Production Recommendations:**
   - Use paid Render plans for better performance
   - Set up monitoring and alerting
   - Implement backup strategies
   - Configure CDN for static assets

## Support and Maintenance

1. **Regular Updates:**
   - Keep dependencies updated
   - Monitor Roboflow model performance
   - Update AI models as needed

2. **Monitoring:**
   - Set up health checks for all services
   - Monitor AI service accuracy and performance
   - Track user engagement and system usage

3. **Backup Strategy:**
   - Regular database backups
   - Image storage backup
   - Configuration backup

## Next Steps

After successful deployment:
1. ‚úÖ Test all system components
2. ‚úÖ Verify AI disease detection accuracy
3. ‚úÖ Set up monitoring and alerting
4. ‚úÖ Configure backup strategies
5. ‚úÖ Plan for scaling as user base grows
6. ‚úÖ Implement CI/CD pipelines for automated deployments
7. ‚úÖ Train additional AI models for more diseases
8. ‚úÖ Expand veterinarian network and coverage

## Live URLs (After Deployment)

- **Frontend Application**: `https://cattle-health-frontend.onrender.com`
- **Backend API**: `https://cattle-health-backend.onrender.com/api`
- **AI Service**: `https://cattle-health-ai.onrender.com`
- **Admin Panel**: `https://cattle-health-backend.onrender.com/admin`

The complete system provides a comprehensive cattle health management solution with cutting-edge AI disease detection capabilities powered by Roboflow.